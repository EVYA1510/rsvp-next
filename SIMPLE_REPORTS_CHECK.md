# בדיקת דיווחים פשוטה - 3 שעות אחרונות

## 🚀 פונקציה פשוטה לבדיקת דיווחי "אולי" ו"לא מגיע"

### 📋 הפונקציה החדשה:

```javascript
function checkReports()
```

### 🛠️ איך להשתמש:

#### **שיטה 1: ישירות מ-Google Apps Script Editor**

1. **פתח את Google Apps Script**
2. **העתק את הקוד החדש** מ-`קוד.js`
3. **שמור את הפרויקט**
4. **בחר את הפונקציה** `checkReports` מהרשימה הנפתחת
5. **לחץ על "Run" (▶️)**
6. **בדוק את הלוגים** בחלון "Execution log"

#### **שיטה 2: דרך API**

```javascript
const response = await fetch("YOUR_SCRIPT_URL", {
  method: "POST",
  headers: { "Content-Type": "application/x-www-form-urlencoded" },
  body: new URLSearchParams({
    action: "check_recent_reports",
  }),
});
```

### 📊 מה הפונקציה עושה:

1. **בודקת את גיליון "RSVP Responses"**
2. **מחפשת דיווחי "אולי" ו"לא מגיע"** מ-3 השעות האחרונות
3. **מדפיסה ללוג:**
   - מספר דיווחי "אולי" ב-3 שעות
   - מספר דיווחי "לא מגיע" ב-3 שעות
   - פירוט כל דיווח עם שם, זמן ומספר שעות שעברו
   - סטטיסטיקות כללית

### 📝 דוגמה לתוצאה בלוג:

```
🔍 בודק דיווחים מ-13/08/2025, 12:00:00 עד עכשיו
📊 סה"כ שורות בנתונים: 15
📈 תוצאות הבדיקה:
🟠 דיווחי 'אולי' ב-3 שעות: 2
🔴 דיווחי 'לא מגיע' ב-3 שעות: 1
📋 סה"כ דיווחים רלוונטיים: 3
📝 פירוט הדיווחים:
1. שובל בן בכר - אולי (לפני 1.5 שעות, 13/08/2025, 13:30:00)
2. אביתר כהן - אולי (לפני 2.1 שעות, 13/08/2025, 12:45:00)
3. דנה לוי - לא מגיע (לפני 0.8 שעות, 13/08/2025, 14:15:00)
📊 סטטיסטיקות כללית:
🟠 סה"כ דיווחי 'אולי' בכל הזמן: 5
🔴 סה"כ דיווחי 'לא מגיע' בכל הזמן: 2
```

### ⚡ הוראות מהירות:

1. **העתק את הקוד** מ-`קוד.js` ל-Google Apps Script
2. **שמור את הפרויקט**
3. **הפעל `checkReports()`**
4. **בדוק את הלוגים** בחלון Execution log
5. **תראה בדיוק מה קורה** עם הדיווחים האחרונים

### 🎯 מה תקבל:

- ✅ **מספר מדויק** של דיווחי "אולי" ו"לא מגיע" ב-3 שעות
- ✅ **פירוט מלא** של כל דיווח עם זמן מדויק
- ✅ **סטטיסטיקות כללית** של כל הזמן
- ✅ **לוגים ברורים** בעברית

### 🔧 התאמה אישית:

אם אתה רוצה לשנות את הזמן (למשל ל-6 שעות במקום 3):

```javascript
// שנה את השורה הזו ב-checkRecentReports:
const threeHoursAgo = new Date(now.getTime() - 6 * 60 * 60 * 1000); // 6 שעות
```

**זהו! פונקציה פשוטה ומהירה לבדיקת מה קורה עם הדיווחים האחרונים.** 🎉
